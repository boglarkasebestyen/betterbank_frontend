{"ast":null,"code":"var _jsxFileName = \"/Users/sebestyenboglarka/Desktop/_uWu/MIT_MERN_2021-'22/3rd semester/badbank_backend_test/betterbank_frontend/src/pages/Login.js\",\n    _s = $RefreshSig$();\n\nimport React, { useContext } from \"react\";\nimport { MyContext } from \"../myContext/MyContext\";\nimport { useHistory } from \"react-router-dom\";\nimport Card from \"../components/Card\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nfunction Login() {\n  _s();\n\n  const {\n    //state\n    userName,\n    password,\n    userNameError,\n    passwError,\n    //functions\n    handleClickLogin,\n    handleUserNameChange,\n    handlePasswordChange,\n    showSuccessMessageLogin,\n    clearform\n  } = useContext(MyContext);\n  /*\n  The useHistory hook allows us to access React Router's history object.\n  \tThrough the history object, we can access and manipulate the current state of the browser history.\n  \tAll we need to do is to call the useHistory hook inside a functional component.\n  \tWe can use this object to redirect the user to another page by calling history.push('/example-route').\n  */\n  //redirects me to Create Account when clicking \"Open Account\" in Login \n\n  const history = useHistory();\n\n  const redirect = () => {\n    // history.push('/createAccount');\n    // using the href from Navigation, not the \"path\" I was thinking I need: {id:\"createAccount\", text: \"Open Acount\", tooltipText: \"Open your BetterBank® account\", href:\"#/createAccount\"}\n    // I don't want to be able to go back in the browser:\n    history.replace('/createAccount');\n  };\n\n  const [user, setUser] = useState({\n    username: \"\",\n    password: \"\"\n  });\n  const [error, setError] = useState(\"\");\n\n  async function authenticateWithAPI() {\n    const API_URL = process.env.NEXT_PUBLIC_API_URL || \"http://localhost:1337\";\n    const response = await fetch(`${API_URL}/auth/local`, {\n      method: \"POST\",\n      headers: {\n        \"Accept\": \"application/json\",\n        \"Content-Type\": \"application/json\"\n      },\n      body: JSON.stringify({\n        identifier: \"sebestyenboglarkacsilla@gmail.com\",\n        password: \"SecretPassword666\"\n      })\n    });\n\n    if (response.ok) {\n      const responseObj = await response.json();\n      Cookies.set(\"token\", responseObj.jwt);\n    } else {\n      console.log(response.statusText);\n      setError(response.statusText);\n    }\n  }\n\n  async function getUser() {\n    if (validate()) {\n      // redirect();\n      clearForm();\n    }\n\n    if (!validate()) {\n      return;\n    }\n\n    const API_URL = process.env.NEXT_PUBLIC_API_URL || \"http://localhost:1337\";\n    let userToken = Cookies.get(\"token\");\n\n    if (!userToken) {\n      authenticateWithAPI();\n      userToken = Cookies.get(\"token\");\n      console.log(userToken);\n    }\n\n    const response = await fetch(`${API_URL}/newusers`, {\n      method: \"POST\",\n      headers: userToken && {\n        Authorization: `Bearer ${userToken}`\n      },\n      body: JSON.stringify({\n        firstname: firstName,\n        lastname: lastName,\n        username: userName,\n        email: email,\n        password: password\n      })\n    });\n\n    if (!response.ok) {\n      console.log(response.statusText);\n      setError(response.statusText);\n    } else {\n      console.log(\"Success\");\n      const responseObj = await response.json();\n      const error = responseObj.error;\n\n      if (error) {\n        setError(error);\n      }\n    }\n  }\n\n  return /*#__PURE__*/_jsxDEV(Card, {\n    bgcolor: \"warning\",\n    header: \"Account log in\",\n    body: /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [(() => {\n        if (userNameError) {\n          return /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"error\",\n            children: userNameError\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 125,\n            columnNumber: 9\n          }, this);\n        }\n      })(), (() => {\n        if (passwError) {\n          return /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"error\",\n            children: passwError\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 133,\n            columnNumber: 9\n          }, this);\n        }\n      })(), showSuccessMessageLogin(), /*#__PURE__*/_jsxDEV(\"h6\", {\n        className: \"login-text mt-5\",\n        children: \"Username\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 141,\n        columnNumber: 6\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"input\",\n        className: \"form-control\",\n        id: \"username\",\n        placeholder: \"@\",\n        value: userName,\n        onChange: handleUserNameChange\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 142,\n        columnNumber: 6\n      }, this), /*#__PURE__*/_jsxDEV(\"h6\", {\n        className: \"login-text mt-4\",\n        children: \"Password\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 143,\n        columnNumber: 6\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"password\",\n        className: \"form-control\",\n        id: \"password\",\n        placeholder: \"**********\",\n        value: password,\n        onChange: handlePasswordChange\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 144,\n        columnNumber: 6\n      }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 145,\n        columnNumber: 6\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        type: \"submit\",\n        disabled: !userName && !password,\n        id: \"login\",\n        className: \"submitBtn btn btn-light\",\n        onClick: e => handleClickLogin(),\n        children: \"Log in\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 146,\n        columnNumber: 6\n      }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 147,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(\"h6\", {\n        className: \"account-text font-weight-bold mt-4\",\n        children: \"Don't have an account yet?\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 148,\n        columnNumber: 6\n      }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 149,\n        columnNumber: 6\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        type: \"submit\",\n        id: \"create\",\n        className: \"submitBtn btn btn-light\",\n        onClick: redirect,\n        children: \"Open Account\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 150,\n        columnNumber: 6\n      }, this)]\n    }, void 0, true)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 116,\n    columnNumber: 3\n  }, this);\n}\n\n_s(Login, \"vUKNFGHmRmGy2hvlGa/UThW/5Pc=\", false, function () {\n  return [useHistory];\n});\n\n_c = Login;\nexport default Login;\n\nvar _c;\n\n$RefreshReg$(_c, \"Login\");","map":{"version":3,"sources":["/Users/sebestyenboglarka/Desktop/_uWu/MIT_MERN_2021-'22/3rd semester/badbank_backend_test/betterbank_frontend/src/pages/Login.js"],"names":["React","useContext","MyContext","useHistory","Card","Login","userName","password","userNameError","passwError","handleClickLogin","handleUserNameChange","handlePasswordChange","showSuccessMessageLogin","clearform","history","redirect","replace","user","setUser","useState","username","error","setError","authenticateWithAPI","API_URL","process","env","NEXT_PUBLIC_API_URL","response","fetch","method","headers","body","JSON","stringify","identifier","ok","responseObj","json","Cookies","set","jwt","console","log","statusText","getUser","validate","clearForm","userToken","get","Authorization","firstname","firstName","lastname","lastName","email","e"],"mappings":"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","sourcesContent":["import React, {useContext} from \"react\";\nimport {MyContext} from \"../myContext/MyContext\";\nimport {useHistory} from \"react-router-dom\";\nimport Card from \"../components/Card\";\n\nfunction Login() {\n\n\tconst {\n\t\t//state\n    \tuserName,\n\t\tpassword,\n\t\tuserNameError,\n\t\tpasswError,\n\t\t//functions\n    \thandleClickLogin,\n\t\thandleUserNameChange,\n\t\thandlePasswordChange,\n    \tshowSuccessMessageLogin,\n\t\tclearform\n\t} = useContext(MyContext);\n\n\t/*\n\tThe useHistory hook allows us to access React Router's history object.\n\n\tThrough the history object, we can access and manipulate the current state of the browser history.\n\n\tAll we need to do is to call the useHistory hook inside a functional component.\n\n\tWe can use this object to redirect the user to another page by calling history.push('/example-route').\n\t*/\n\n\t//redirects me to Create Account when clicking \"Open Account\" in Login \n\tconst history = useHistory();\n  \tconst redirect = () => {\n    // history.push('/createAccount');\n\t\t// using the href from Navigation, not the \"path\" I was thinking I need: {id:\"createAccount\", text: \"Open Acount\", tooltipText: \"Open your BetterBank® account\", href:\"#/createAccount\"}\n\t\t// I don't want to be able to go back in the browser:\n\t\thistory.replace('/createAccount');\n  \t}\n\n\n\tconst [user, setUser] = useState({\n\t\tusername: \"\",\n\t\tpassword: \"\"\n\t});\n\tconst [error, setError] = useState(\"\");\n\n\tasync function authenticateWithAPI() {\n\t\tconst API_URL = process.env.NEXT_PUBLIC_API_URL || \"http://localhost:1337\";\n\t\tconst response = await fetch(`${API_URL}/auth/local`, {\n\t\t  method: \"POST\",\n\t\t\theaders: {\n\t\t\t\t\"Accept\": \"application/json\",\n\t\t\t\t\"Content-Type\": \"application/json\"\n\t\t\t},\n\t\t  body: JSON.stringify({\n\t\t\t\tidentifier: \"sebestyenboglarkacsilla@gmail.com\",\n\t\t\t\tpassword: \"SecretPassword666\"\n\t\t\t})\n\t\t});\n\n\t\tif (response.ok) {\n\t\t\tconst responseObj = await response.json();\n\t\t\tCookies.set(\"token\", responseObj.jwt);\n\t\t} else {\n\t\t\tconsole.log(response.statusText)\n\t\t\tsetError(response.statusText);\n\t\t}\n\t}\n\n\tasync function getUser() {\n\n\t\tif(validate()) {\n\t\t\t// redirect();\n\t\t\tclearForm();\n\t\t}\n\n\t\tif (!validate()) {\n\t\t\treturn;\n\t\t}\n\t\t\n\t\tconst API_URL = process.env.NEXT_PUBLIC_API_URL || \"http://localhost:1337\";\n    let userToken = Cookies.get(\"token\");\n\t\tif (!userToken) {\n\t\t\tauthenticateWithAPI();\n\t\t  userToken = Cookies.get(\"token\");\n\t\t\tconsole.log(userToken);\n\t\t}\n\n\t\tconst response = await fetch(`${API_URL}/newusers`, {\n\t\t  method: \"POST\",\n\t\t\theaders: userToken && { Authorization: `Bearer ${userToken}` },\n\t\t  body: JSON.stringify({\n\t\t\t\tfirstname: firstName,\n\t\t\t\tlastname: lastName,\n\t\t\t\tusername: userName,\n\t\t\t\temail: email,\n\t\t\t\tpassword: password,\n\t\t  }),\n\t\t});\n\t\n\t\tif (!response.ok) {\n\t\t\tconsole.log(response.statusText)\n\t\t  setError(response.statusText);\n\t\t} else {\n\t\t\tconsole.log(\"Success\");\n\t\t\tconst responseObj = await response.json();\n\t\t\tconst error = responseObj.error;\n\t\t\tif (error) {\n\t\t\t\tsetError(error);\n\t\t\t}\n\t\t}\n\t}\t\n\n\treturn (\n\t\t<Card\n\t\t\tbgcolor=\"warning\"\n\t\t\theader=\"Account log in\"\n\t\t\tbody={\n\t\t\t\t<>\n\t\t\t\t{/* it can't be done with if/else or without else */} \n\t\t\t\t\t{(() => {\n\t\t\t\t\t\tif (userNameError) {\n\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t<div className=\"error\">{userNameError}</div>\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\t\t\t\t\t})()}\n\t\t\t\t\t\n\t\t\t\t\t{(() => {\n\t\t\t\t\t\tif (passwError) {\n\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t<div className=\"error\">{passwError}</div>\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\t\t\t\t\t})()}\n\n\n          {showSuccessMessageLogin()}\n\t\t\t\t\t\n\t\t\t\t\t<h6 className=\"login-text mt-5\">Username</h6>\n\t\t\t\t\t<input type=\"input\" className=\"form-control\" id=\"username\" placeholder=\"@\" value={userName} onChange={handleUserNameChange}/>\n\t\t\t\t\t<h6 className=\"login-text mt-4\">Password</h6>\n\t\t\t\t\t<input type=\"password\" className=\"form-control\" id=\"password\" placeholder=\"**********\" value={password} onChange={handlePasswordChange}/>\n\t\t\t\t\t<br/>\n\t\t\t\t\t<button type=\"submit\" disabled={!userName && !password} id=\"login\" className=\"submitBtn btn btn-light\" onClick={e => handleClickLogin()} >Log in</button>\n\t\t\t\t\t\t<br/>\n\t\t\t\t\t<h6 className=\"account-text font-weight-bold mt-4\">Don't have an account yet?</h6>\n\t\t\t\t\t<br/>\n\t\t\t\t\t<button type=\"submit\" id=\"create\" className=\"submitBtn btn btn-light\" onClick={redirect} >Open Account</button>\n\t\t\t\t</>\n\t\t\t\t}\n\t\t/>\n\t)\n}\n\nexport default Login;"]},"metadata":{},"sourceType":"module"}