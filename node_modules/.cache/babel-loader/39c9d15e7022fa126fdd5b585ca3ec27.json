{"ast":null,"code":"import _asyncToGenerator from\"/Users/sebestyenboglarka/Desktop/_uWu/MIT_MERN_2021-'22/3rd semester/badbank_backend_test/betterbank_frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _regeneratorRuntime from\"/Users/sebestyenboglarka/Desktop/_uWu/MIT_MERN_2021-'22/3rd semester/badbank_backend_test/betterbank_frontend/node_modules/@babel/runtime/regenerator/index.js\";import React,{useContext,useEffect,useState}from\"react\";import{MyContext}from\"../myContext/MyContext\";import Card from\"../components/Card\";import Cookies from\"js-cookie\";import gif from\"../images/gif.gif\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";function Invest(){var _useContext=useContext(MyContext),balance=_useContext.balance,error=_useContext.error,investError=_useContext.investError,investSuccessMessageVisible=_useContext.investSuccessMessageVisible,investAmount=_useContext.investAmount,investResult=_useContext.investResult,validateInvest=_useContext.validateInvest,setError=_useContext.setError,authenticateWithAPI=_useContext.authenticateWithAPI,getBalance=_useContext.getBalance,investHandleChange=_useContext.investHandleChange,setInvestSuccessMessageVisible=_useContext.setInvestSuccessMessageVisible,setInvestAmount=_useContext.setInvestAmount,setInvestResult=_useContext.setInvestResult;useEffect(function(){getBalance();});function submitInvest(){return _submitInvest.apply(this,arguments);}function _submitInvest(){_submitInvest=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var userToken,username,API_URL,response,responseObj,_error;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(validateInvest()){_context.next=2;break;}return _context.abrupt(\"return\");case 2:userToken=Cookies.get(\"token\");if(!userToken){authenticateWithAPI();userToken=Cookies.get(\"token\");}username=Cookies.get(\"username\");API_URL=process.env.NEXT_PUBLIC_API_URL||\"http://localhost:1337\";_context.next=8;return fetch(\"\".concat(API_URL,\"/transactions/invest\"),{method:\"POST\",headers:userToken&&{Authorization:\"Bearer \".concat(userToken)},body:JSON.stringify({to:username,from:username,amount:investAmount})});case 8:response=_context.sent;setError(\"\");if(response.ok){_context.next=14;break;}setError(response.statusText);_context.next=20;break;case 14:_context.next=16;return response.json();case 16:responseObj=_context.sent;_error=responseObj.error;if(_error){setError(_error);}else{console.log(\"invest result: \"+responseObj.result);setInvestResult(responseObj.result===1);setInvestSuccessMessageVisible(true);}getBalance();case 20:;case 21:case\"end\":return _context.stop();}}},_callee);}));return _submitInvest.apply(this,arguments);};function investOkBtn(){window.open(\"https://www.lamborghinistore.com/us/\");setInvestAmount(\"\");setInvestSuccessMessageVisible(false);}return/*#__PURE__*/_jsx(Card,{bgcolor:\"warning\",header:\"Invest\",body:/*#__PURE__*/_jsxs(_Fragment,{children:[function(){if(investSuccessMessageVisible===true){if(investResult){return/*#__PURE__*/_jsxs(\"div\",{className:\"successMessage\",children:[/*#__PURE__*/_jsx(\"h5\",{children:\"(\\u02F5 \\u0361\\xB0 \\u035C\\u0296 \\u0361\\xB0\\u02F5)\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Your investment has doubled the added amount!\"}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",id:\"redirectToLambo\",className:\"submitBtn btn btn-light\",onClick:function onClick(){return investOkBtn();},children:\"Ok\"})]});}else{return/*#__PURE__*/_jsx(\"div\",{className:\"successMessage\",children:/*#__PURE__*/_jsx(\"img\",{src:gif,alt:\"animated gif\"})});}}}(),function(){if(investError){return/*#__PURE__*/_jsx(\"div\",{className:\"error\",children:investError});}}(),function(){if(error){return/*#__PURE__*/_jsx(\"div\",{className:\"error\",children:error});}}(),/*#__PURE__*/_jsxs(\"h6\",{className:\"invest-text mt-4 mb-5 font-weight-bolder\",children:[\"Your current balance is: $\",balance]}),/*#__PURE__*/_jsx(\"h6\",{className:\"invest-text mt-4 mb-2 font-weight-bolder\",children:\"The amount you wish to invest:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"input\",className:\"form-control\",value:investAmount,onChange:investHandleChange}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",disabled:!investAmount,className:\"submitBtn btn btn-light\",id:\"submitbutton\",onClick:function onClick(){return submitInvest();},children:\"Invest\"})]})});}export default Invest;","map":{"version":3,"sources":["/Users/sebestyenboglarka/Desktop/_uWu/MIT_MERN_2021-'22/3rd semester/badbank_backend_test/betterbank_frontend/src/pages/Invest.js"],"names":["React","useContext","useEffect","useState","MyContext","Card","Cookies","gif","Invest","balance","error","investError","investSuccessMessageVisible","investAmount","investResult","validateInvest","setError","authenticateWithAPI","getBalance","investHandleChange","setInvestSuccessMessageVisible","setInvestAmount","setInvestResult","submitInvest","userToken","get","username","API_URL","process","env","NEXT_PUBLIC_API_URL","fetch","method","headers","Authorization","body","JSON","stringify","to","from","amount","response","ok","statusText","json","responseObj","console","log","result","investOkBtn","window","open"],"mappings":"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","sourcesContent":["import React, {useContext, useEffect, useState} from \"react\";\nimport {MyContext} from \"../myContext/MyContext\";\nimport Card from \"../components/Card\";\nimport Cookies from \"js-cookie\";\nimport gif from \"../images/gif.gif\";\n\nfunction Invest() {\n\n\tconst {\n\t\t//state:\n\t\tbalance,\n\t\terror,\n\t\tinvestError,\n\t\tinvestSuccessMessageVisible,\n\t\tinvestAmount,\n\t\tinvestResult,\n\t\t//functions:\n\t\tvalidateInvest,\n\t\tsetError,\n\t\tauthenticateWithAPI ,\n\t\tgetBalance,\n\t\tinvestHandleChange,\n\t\tsetInvestSuccessMessageVisible,\n\t\tsetInvestAmount,\n\t\tsetInvestResult\n\t} = useContext(MyContext);\n\n\t\n\n\tuseEffect(()=> {\n\t\tgetBalance();\n\t}); \n\t\n\n\tasync function submitInvest() {\n\t\tif(!validateInvest()) {\n\t\t\treturn;\n\t\t}\n\n\t\tlet userToken = Cookies.get(\"token\");\n\t\t\tif (!userToken) {\n\t\t\t\tauthenticateWithAPI();\n\t\t\t\tuserToken = Cookies.get(\"token\");\n\t\t\t}\n\n\t\t\tlet username = Cookies.get(\"username\");\n\t\t\t\n\t\t\tconst API_URL = process.env.NEXT_PUBLIC_API_URL || \"http://localhost:1337\";\n\t\t\tconst response = await fetch(`${API_URL}/transactions/invest`, {\n\t\t\t\tmethod: \"POST\",\n\t\t\t\theaders: userToken && { Authorization: `Bearer ${userToken}` },\n\t\t\t\tbody: JSON.stringify({\n\t\t\t\t\tto: username,\n\t\t\t\t\tfrom: username,\n\t\t\t\t\tamount: investAmount\n\t\t\t\t}),\n\t\t\t});\n\n\n\t\tsetError(\"\");\n    if (!response.ok) {\n\t\t  setError(response.statusText);\n\t\t} else {\n\t\t\tconst responseObj = await response.json();\n\t\t\tconst error = responseObj.error;\n\t\t\tif (error) {\n\t\t\t\tsetError(error);\n\t\t\t} else {\n\t\t\t\tconsole.log(\"invest result: \" + responseObj.result);\n        setInvestResult(responseObj.result === 1);\t\t\t\n\t\t\t\tsetInvestSuccessMessageVisible(true);\n      }\n\t\t\tgetBalance();\n\t\t};\n  };\n\n\n\tfunction investOkBtn() {\n\t\twindow.open(\"https://www.lamborghinistore.com/us/\")\n\t\tsetInvestAmount(\"\");\n  \tsetInvestSuccessMessageVisible(false);\n\t}\n\n\treturn (\n\t\t<Card\n\t\t\t\tbgcolor=\"warning\"\n\t\t\t\theader=\"Invest\"\n\t\t\t\tbody= {\n\t\t\t\t\t<>  \n\t\t\t\t\t\t{(() => {\n\t\t\t\t\t\t\tif (investSuccessMessageVisible === true) {\n\t\t\t\t\t\t\t\tif (investResult) {\n\t\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\t\t<div className=\"successMessage\">\n\t\t\t\t\t\t\t\t\t\t\t<h5>(˵ ͡° ͜ʖ ͡°˵)</h5>\n\t\t\t\t\t\t\t\t\t\t\t<p>Your investment has doubled the added amount!</p>\n\t\t\t\t\t\t\t\t\t\t\t<button type=\"submit\" id=\"redirectToLambo\" className=\"submitBtn btn btn-light\" onClick={() => investOkBtn()}>Ok</button>             \n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\t\t<div className=\"successMessage\">\n\t\t\t\t\t\t\t\t\t\t\t<img src={gif} alt=\"animated gif\" />\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n            })()}\n\n\n\t\t\t\t\t\t{(() => {\n              if (investError) {\n                return (\n                  <div className=\"error\">{investError}</div>\n                  );\n              }\n            })()}\n\n\t\t\t\t\t\t{(() => {\n              if (error) {\n                return (\n                  <div className=\"error\">{error}</div>\n                  );\n              }\n            })()}\n\n\t\t\t\t\t\t<h6 className=\"invest-text mt-4 mb-5 font-weight-bolder\" >Your current balance is: ${balance}</h6>\n\t\t\t\t\t\t{/* amount */}\n\t\t\t\t\t\t<h6 className=\"invest-text mt-4 mb-2 font-weight-bolder\">The amount you wish to invest:</h6>\n\t\t\t\t\t\t{/* added value so that state can change */}\n\t\t\t\t\t\t<input type=\"input\" className=\"form-control\" value={investAmount} onChange={investHandleChange}/>\n\t\t\t\t\t\t<br />\n\t\t\t\t\t\t<button type=\"submit\" disabled={!investAmount} className=\"submitBtn btn btn-light\" id=\"submitbutton\" onClick={() => submitInvest()}>Invest</button> \n\t\t\t\t\t</>\n\t\t\t\t}  \n\t\t/>\n\t)\n}\n\nexport default Invest;"]},"metadata":{},"sourceType":"module"}