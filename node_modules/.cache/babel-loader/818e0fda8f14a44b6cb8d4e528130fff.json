{"ast":null,"code":"var _jsxFileName = \"/Users/sebestyenboglarka/Desktop/_uWu/MIT_MERN_2021-'22/3rd semester/badbank_backend_test/betterbank_frontend/src/pages/Login.js\",\n    _s = $RefreshSig$();\n\nimport React, { useContext, useState } from \"react\";\nimport { useHistory } from \"react-router-dom\";\nimport { MyContext } from \"../myContext/MyContext\";\nimport Card from \"../components/Card\";\nimport Cookies from \"js-cookie\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nfunction Login() {\n  _s();\n\n  const {\n    //state\n    firstName,\n    userName,\n    password,\n    userNameError,\n    passwError,\n    error,\n    result,\n    loggedInUserName,\n    //functions\n    handleClickLogin,\n    handleUserNameChange,\n    handlePasswordChange,\n    showSuccessMessageLogin,\n    validate,\n    clearForm,\n    authenticateWithAPI,\n    setError,\n    setResult,\n    clearLoginForm,\n    setLoggedInUserName,\n    clearMsgLogin\n  } = useContext(MyContext);\n  /*\n  The useHistory hook allows us to access React Router's history object.\n  \tThrough the history object, we can access and manipulate the current state of the browser history.\n  \tAll we need to do is to call the useHistory hook inside a functional component.\n  \tWe can use this object to redirect the user to another page by calling history.push('/example-route').\n  */\n  //redirects me to Create Account when clicking \"Open Account\" in Login \n\n  const history = useHistory();\n\n  const redirect = () => {\n    // history.push('/createAccount');\n    // using the href from Navigation, not the \"path\" I was thinking I need: {id:\"createAccount\", text: \"Open Acount\", tooltipText: \"Open your BetterBank® account\", href:\"#/createAccount\"}\n    // I don't want to be able to go back in the browser:\n    history.replace('/createAccount');\n  };\n\n  const [user, setUser] = useState({\n    username: \"\",\n    password: \"\"\n  });\n\n  async function loginUser() {\n    let userToken = Cookies.get(\"token\");\n\n    if (!userToken) {\n      authenticateWithAPI();\n      userToken = Cookies.get(\"token\");\n    }\n\n    const API_URL = process.env.NEXT_PUBLIC_API_URL || \"http://localhost:1337\";\n    const response = await fetch(`${API_URL}/newusers/login`, {\n      method: \"POST\",\n      headers: userToken && {\n        Authorization: `Bearer ${userToken}`\n      },\n      body: JSON.stringify({\n        firstname: firstName,\n        username: userName,\n        password: password\n      })\n    });\n\n    if (!response.ok) {\n      setResult(response.statusText);\n    } else {\n      const responseObj = await response.json();\n      console.log(\"Response: \" + JSON.stringify(responseObj));\n      const result = responseObj.result; //if I don't set state, it doesn't appear on the frontend\n\n      setResult(result);\n\n      const redirect = () => {\n        // history.push('/createAccount');\n        // using the href from Navigation, not the \"path\" I was thinking I need: {id:\"createAccount\", text: \"Open Acount\", tooltipText: \"Open your BetterBank® account\", href:\"#/createAccount\"}\n        // I don't want to be able to go back in the browser:\n        history.replace('alldata');\n      }; // result === \"success\" ? \tsetLoggedInUserName(true) : setLoggedInUserName(false);\n\n    }\n  }\n\n  return /*#__PURE__*/_jsxDEV(Card, {\n    bgcolor: \"warning\",\n    header: \"Account log in\",\n    body: /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [(() => {\n        if (result) {\n          return /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"error\",\n            children: result\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 120,\n            columnNumber: 10\n          }, this);\n        }\n      })(), /*#__PURE__*/_jsxDEV(\"h6\", {\n        className: \"login-text mt-5\",\n        children: \"Username\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 128,\n        columnNumber: 6\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"input\",\n        className: \"form-control\",\n        id: \"username\",\n        placeholder: \"@\",\n        value: userName,\n        onChange: handleUserNameChange\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 129,\n        columnNumber: 6\n      }, this), /*#__PURE__*/_jsxDEV(\"h6\", {\n        className: \"login-text mt-4\",\n        children: \"Password\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 130,\n        columnNumber: 6\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"password\",\n        className: \"form-control\",\n        id: \"password\",\n        placeholder: \"**********\",\n        value: password,\n        onChange: handlePasswordChange\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 131,\n        columnNumber: 6\n      }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 132,\n        columnNumber: 6\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        type: \"submit\",\n        disabled: !userName && !password,\n        id: \"login\",\n        className: \"submitBtn btn btn-light\",\n        onClick: e => loginUser(),\n        children: \"Log in\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 133,\n        columnNumber: 6\n      }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 134,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(\"h6\", {\n        className: \"account-text font-weight-bold mt-4\",\n        children: \"Don't have an account yet?\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 135,\n        columnNumber: 6\n      }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 136,\n        columnNumber: 6\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        type: \"submit\",\n        id: \"create\",\n        className: \"submitBtn btn btn-light\",\n        onClick: redirect,\n        children: \"Open Account\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 137,\n        columnNumber: 6\n      }, this)]\n    }, void 0, true)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 98,\n    columnNumber: 3\n  }, this);\n}\n\n_s(Login, \"/JuhHBqhUOLBlotROEjQWPWnRB4=\", false, function () {\n  return [useHistory];\n});\n\n_c = Login;\nexport default Login;\n\nvar _c;\n\n$RefreshReg$(_c, \"Login\");","map":{"version":3,"sources":["/Users/sebestyenboglarka/Desktop/_uWu/MIT_MERN_2021-'22/3rd semester/badbank_backend_test/betterbank_frontend/src/pages/Login.js"],"names":["React","useContext","useState","useHistory","MyContext","Card","Cookies","Login","firstName","userName","password","userNameError","passwError","error","result","loggedInUserName","handleClickLogin","handleUserNameChange","handlePasswordChange","showSuccessMessageLogin","validate","clearForm","authenticateWithAPI","setError","setResult","clearLoginForm","setLoggedInUserName","clearMsgLogin","history","redirect","replace","user","setUser","username","loginUser","userToken","get","API_URL","process","env","NEXT_PUBLIC_API_URL","response","fetch","method","headers","Authorization","body","JSON","stringify","firstname","ok","statusText","responseObj","json","console","log","e"],"mappings":"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","sourcesContent":["import React, {useContext, useState} from \"react\";\nimport {useHistory} from \"react-router-dom\";\nimport {MyContext} from \"../myContext/MyContext\";\nimport Card from \"../components/Card\";\nimport Cookies from \"js-cookie\";\n\nfunction Login() {\n\n\tconst {\n\t\t//state\n\t\tfirstName,\n    userName,\n\t\tpassword,\n\t\tuserNameError,\n\t\tpasswError,\n\t\terror,\n\t\tresult,\n\t\tloggedInUserName,\n\t\t//functions\n    handleClickLogin,\n\t\thandleUserNameChange,\n\t\thandlePasswordChange,\n    showSuccessMessageLogin,\n\t\tvalidate,\n\t\tclearForm,\n\t\tauthenticateWithAPI,\n\t\tsetError,\n\t\tsetResult,\n\t\tclearLoginForm,\n\t\tsetLoggedInUserName,\n\t\tclearMsgLogin\n\n\t} = useContext(MyContext);\n\n\t/*\n\tThe useHistory hook allows us to access React Router's history object.\n\n\tThrough the history object, we can access and manipulate the current state of the browser history.\n\n\tAll we need to do is to call the useHistory hook inside a functional component.\n\n\tWe can use this object to redirect the user to another page by calling history.push('/example-route').\n\t*/\n\n\t//redirects me to Create Account when clicking \"Open Account\" in Login \n\tconst history = useHistory();\n  \tconst redirect = () => {\n    // history.push('/createAccount');\n\t\t// using the href from Navigation, not the \"path\" I was thinking I need: {id:\"createAccount\", text: \"Open Acount\", tooltipText: \"Open your BetterBank® account\", href:\"#/createAccount\"}\n\t\t// I don't want to be able to go back in the browser:\n\t\thistory.replace('/createAccount');\n  \t}\n\n\tconst [user, setUser] = useState({\n\t\tusername: \"\",\n\t\tpassword: \"\"\n\t\t});\n\n\tasync function loginUser() {\n\t\n\t\tlet userToken = Cookies.get(\"token\");\n\t\tif (!userToken) {\n\t\t\tauthenticateWithAPI();\n\t\t\tuserToken = Cookies.get(\"token\");\n\t\t}\n\t\t\n\t\tconst API_URL = process.env.NEXT_PUBLIC_API_URL || \"http://localhost:1337\";\n\t\tconst response = await fetch(`${API_URL}/newusers/login`, {\n\t\t  method: \"POST\",\n\t\t\theaders: userToken && { Authorization: `Bearer ${userToken}` },\n\t\t \tbody: JSON.stringify({\n\t\t\t\tfirstname: firstName,\n\t\t\t\tusername: userName,\n\t\t\t\tpassword: password,\n\t\t  }),\n\t\t});\n\n\t\tif (!response.ok) {\n\t\t \tsetResult(response.statusText);\n\t\t} else {\n\t\t\tconst responseObj = await response.json();\n\t\t\tconsole.log(\"Response: \" + JSON.stringify(responseObj));\n\t\t\tconst result = responseObj.result;\n\t\t\t//if I don't set state, it doesn't appear on the frontend\n\t\t\tsetResult(result);\n\n\t\t\tconst redirect = () => {\n\t\t\t// history.push('/createAccount');\n\t\t\t// using the href from Navigation, not the \"path\" I was thinking I need: {id:\"createAccount\", text: \"Open Acount\", tooltipText: \"Open your BetterBank® account\", href:\"#/createAccount\"}\n\t\t\t// I don't want to be able to go back in the browser:\n\t\t\thistory.replace('alldata');\n\t\t}\n\t\t\t// result === \"success\" ? \tsetLoggedInUserName(true) : setLoggedInUserName(false);\n\t\t}\n\t}\t\n\n\treturn (\n\t\t<Card\n\t\t\tbgcolor=\"warning\"\n\t\t\theader=\"Account log in\"\n\t\t\tbody={\n\t\t\t\t<>\n\t\t\t\t{/* {(() => {\n\t\t\t\t\tconsole.log(\"hey result: \" + result)\n\t\t\t\t\t\tif (loggedInUserName) {\n\t\t\t\t\t\t\t{clearLoginForm()}\n\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t<div className=\"successMessage\">\n\t\t\t\t\t\t\t\t\t<h5>Awesome, {firstName}!</h5>\n\t\t\t\t\t\t\t\t\t<p>You are logged in.</p>\n\t\t\t\t\t\t\t\t\t<p>Get started by using the navigation bar above.</p>\n\t\t\t\t\t\t\t\t\t<button type=\"submit\" id=\"clearLogin\" className=\"submitBtn btn btn-light\" onClick={() => clearMsgLogin()}>Ok</button>             \n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t)} \n\t\t\t\t\t})()} */}\n\n\t\t\t\t\t{(() => {\n\t\t\t\t\t\t\tif (result) {\n\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\t<div className=\"error\">{result}</div>\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t} \n\t\t\t\t\t\t\t})()}\n\n\n\n\t\t\t\t\t\n\t\t\t\t\t<h6 className=\"login-text mt-5\">Username</h6>\n\t\t\t\t\t<input type=\"input\" className=\"form-control\" id=\"username\" placeholder=\"@\" value={userName} onChange={handleUserNameChange}/>\n\t\t\t\t\t<h6 className=\"login-text mt-4\">Password</h6>\n\t\t\t\t\t<input type=\"password\" className=\"form-control\" id=\"password\" placeholder=\"**********\" value={password} onChange={handlePasswordChange}/>\n\t\t\t\t\t<br/>\n\t\t\t\t\t<button type=\"submit\" disabled={!userName && !password} id=\"login\" className=\"submitBtn btn btn-light\" onClick={e => loginUser()} >Log in</button>\n\t\t\t\t\t\t<br/>\n\t\t\t\t\t<h6 className=\"account-text font-weight-bold mt-4\">Don't have an account yet?</h6>\n\t\t\t\t\t<br/>\n\t\t\t\t\t<button type=\"submit\" id=\"create\" className=\"submitBtn btn btn-light\" onClick={redirect} >Open Account</button>\n\t\t\t\t</>\n\t\t\t\t}\n\t\t/>\n\t)\n}\n\nexport default Login;"]},"metadata":{},"sourceType":"module"}