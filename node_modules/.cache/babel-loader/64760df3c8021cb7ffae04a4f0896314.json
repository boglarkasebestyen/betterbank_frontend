{"ast":null,"code":"import _asyncToGenerator from\"/Users/sebestyenboglarka/Desktop/_uWu/MIT_MERN_2021-'22/3rd semester/badbank_backend_test/betterbank_frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/sebestyenboglarka/Desktop/_uWu/MIT_MERN_2021-'22/3rd semester/badbank_backend_test/betterbank_frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/Users/sebestyenboglarka/Desktop/_uWu/MIT_MERN_2021-'22/3rd semester/badbank_backend_test/betterbank_frontend/node_modules/@babel/runtime/regenerator/index.js\";import React,{useContext,useState}from\"react\";import{useHistory}from\"react-router-dom\";import{MyContext}from\"../myContext/MyContext\";import Card from\"../components/Card\";import Cookies from\"js-cookie\";import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function CreateAccount(){var _useContext=useContext(MyContext),firstName=_useContext.firstName,lastName=_useContext.lastName,userName=_useContext.userName,email=_useContext.email,password=_useContext.password,userNameError=_useContext.userNameError,firstNameError=_useContext.firstNameError,lastNameError=_useContext.lastNameError,emailError=_useContext.emailError,passwError=_useContext.passwError,error=_useContext.error,handleFirstNameChange=_useContext.handleFirstNameChange,handleLastNameChange=_useContext.handleLastNameChange,handleUserNameChange=_useContext.handleUserNameChange,handleEmailChange=_useContext.handleEmailChange,handlePasswordChange=_useContext.handlePasswordChange,validate=_useContext.validate,clearForm=_useContext.clearForm,authenticateWithAPI=_useContext.authenticateWithAPI,setError=_useContext.setError;var history=useHistory();var redirectToLogin=function redirectToLogin(){// history.push('/createAccount');\n// using the href from Navigation, not the \"path\" I was thinking I need: {id:\"createAccount\", text: \"Open Acount\", tooltipText: \"Open your BetterBank® account\", href:\"#/createAccount\"}\n// I don't want to be able to go back in the browser:\nhistory.replace({pathname:'/',search:\"\",state:{isRedirectFromCreateAccount:true}});};var _useState=useState({firstname:\"\",lastname:\"\",username:\"\",email:\"\",password:\"\"}),_useState2=_slicedToArray(_useState,2),user=_useState2[0],setUser=_useState2[1];function submitUser(){return _submitUser.apply(this,arguments);}function _submitUser(){_submitUser=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var API_URL,userToken,response,responseObj,_error;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(validate()){_context.next=2;break;}return _context.abrupt(\"return\");case 2:authenticateWithAPI();API_URL=process.env.NEXT_PUBLIC_API_URL||\"http://localhost:1337\";userToken=Cookies.get(\"token\");if(!userToken){authenticateWithAPI();userToken=Cookies.get(\"token\");}_context.next=8;return fetch(\"\".concat(API_URL,\"/newusers\"),{method:\"POST\",headers:userToken&&{Authorization:\"Bearer \".concat(userToken)},body:JSON.stringify({firstname:firstName,lastname:lastName,username:userName,email:email,password:password})});case 8:response=_context.sent;if(response.ok){_context.next=14;break;}console.log(response.statusText);setError(response.statusText);_context.next=19;break;case 14:_context.next=16;return response.json();case 16:responseObj=_context.sent;_error=responseObj.error;if(_error){setError(_error);}else{clearForm();redirectToLogin();}case 19:case\"end\":return _context.stop();}}},_callee);}));return _submitUser.apply(this,arguments);}return/*#__PURE__*/_jsx(Card,{bgcolor:\"warning\",header:\"Open Account\",body:/*#__PURE__*/_jsxs(_Fragment,{children:[function(){if(error){return/*#__PURE__*/_jsx(\"div\",{className:\"error\",children:error});}}(),function(){if(userNameError){return/*#__PURE__*/_jsx(\"div\",{className:\"error\",children:userNameError});}}(),function(){if(firstNameError){return/*#__PURE__*/_jsx(\"div\",{className:\"error\",children:firstNameError});}}(),function(){if(lastNameError){return/*#__PURE__*/_jsx(\"div\",{className:\"error\",children:lastNameError});}}(),function(){if(emailError){return/*#__PURE__*/_jsx(\"div\",{className:\"error\",children:emailError});}}(),function(){if(passwError){return/*#__PURE__*/_jsx(\"div\",{className:\"error\",children:passwError});}}(),/*#__PURE__*/_jsx(\"h6\",{className:\"card-text mt-5 mb-2\",children:\"Username\"}),/*#__PURE__*/_jsx(\"input\",{type:\"input\",className:\"form-control\",id:\"username\",placeholder:\"Create a username.\",value:userName,onChange:handleUserNameChange}),/*#__PURE__*/_jsx(\"h6\",{className:\"card-text mt-4 mb-2\",children:\"First Name\"}),/*#__PURE__*/_jsx(\"input\",{type:\"input\",className:\"form-control\",id:\"name\",placeholder:\"Your first name is...\",value:firstName,onChange:handleFirstNameChange}),/*#__PURE__*/_jsx(\"h6\",{className:\"card-text mt-4 mb-2\",children:\"Last Name\"}),/*#__PURE__*/_jsx(\"input\",{type:\"input\",className:\"form-control\",id:\"name\",placeholder:\"Your last name is...\",value:lastName,onChange:handleLastNameChange}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"h6\",{className:\"card-text mb-2\",children:\"Email address\"}),/*#__PURE__*/_jsx(\"input\",{type:\"input\",className:\"form-control\",id:\"email\",placeholder:\"Your email address is...\",value:email,onChange:handleEmailChange}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"h6\",{className:\"card-text mb-2\",children:\"Password\"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",className:\"form-control\",id:\"password\",placeholder:\"**********\",value:password,onChange:handlePasswordChange}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",disabled:!userName&&!firstName&&!lastName&&!email&&!password,id:\"submitbutton\",className:\"submitBtn btn btn-light\",onClick:function onClick(e){return submitUser();},children:\"Create Account\"})]})});}export default CreateAccount;","map":{"version":3,"sources":["/Users/sebestyenboglarka/Desktop/_uWu/MIT_MERN_2021-'22/3rd semester/badbank_backend_test/betterbank_frontend/src/pages/CreateAccount.js"],"names":["React","useContext","useState","useHistory","MyContext","Card","Cookies","CreateAccount","firstName","lastName","userName","email","password","userNameError","firstNameError","lastNameError","emailError","passwError","error","handleFirstNameChange","handleLastNameChange","handleUserNameChange","handleEmailChange","handlePasswordChange","validate","clearForm","authenticateWithAPI","setError","history","redirectToLogin","replace","pathname","search","state","isRedirectFromCreateAccount","firstname","lastname","username","user","setUser","submitUser","API_URL","process","env","NEXT_PUBLIC_API_URL","userToken","get","fetch","method","headers","Authorization","body","JSON","stringify","response","ok","console","log","statusText","json","responseObj","e"],"mappings":"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","sourcesContent":["import React, {useContext, useState} from \"react\";\nimport {useHistory} from \"react-router-dom\";\nimport {MyContext} from \"../myContext/MyContext\";\nimport Card from \"../components/Card\";\nimport Cookies from \"js-cookie\";\n\nfunction CreateAccount() {\n\n\tconst {\n\t\t//state\n\t\tfirstName,\n\t\tlastName,\n\t\tuserName,\n\t\temail,\n\t\tpassword,\n\t\tuserNameError,\n\t\tfirstNameError,\n\t\tlastNameError,\n\t\temailError,\n\t\tpasswError,\n\t\terror,\n\t\t//functions\n\t\thandleFirstNameChange,\n\t\thandleLastNameChange,\n\t\thandleUserNameChange,\n\t\thandleEmailChange,\n\t\thandlePasswordChange,\n\t\tvalidate,\n\t\tclearForm,\n\t\tauthenticateWithAPI,\n\t\tsetError,\n\t} = useContext(MyContext);\n\n\tconst history = useHistory();\n  \tconst redirectToLogin = () => {\n    // history.push('/createAccount');\n\t\t// using the href from Navigation, not the \"path\" I was thinking I need: {id:\"createAccount\", text: \"Open Acount\", tooltipText: \"Open your BetterBank® account\", href:\"#/createAccount\"}\n\t\t// I don't want to be able to go back in the browser:\n\t\thistory.replace({pathname: '/', search: \"\", state: {isRedirectFromCreateAccount : true}});\n  }\n\n\tconst [user, setUser] = useState({\n\t\tfirstname: \"\",\n\t\tlastname: \"\",\n\t\tusername: \"\",\n\t\temail: \"\",\n\t\tpassword: \"\"\n\t});\n\n\tasync function submitUser() {\n\t\tif (!validate()) {\n\t\t\treturn;\n\t\t}\n\n\t\tauthenticateWithAPI();\n\t\t\n\t\tconst API_URL = process.env.NEXT_PUBLIC_API_URL || \"http://localhost:1337\";\n    \tlet userToken = Cookies.get(\"token\");\n\t\t\tif (!userToken) {\n\t\t\tauthenticateWithAPI();\n\t\t  userToken = Cookies.get(\"token\");\n\t\t}\n\n\t\tconst response = await fetch(`${API_URL}/newusers`, {\n\t\t  method: \"POST\",\n\t\t\theaders: userToken && { Authorization: `Bearer ${userToken}` },\n\t\t  body: JSON.stringify({\n\t\t\t\tfirstname: firstName,\n\t\t\t\tlastname: lastName,\n\t\t\t\tusername: userName,\n\t\t\t\temail: email,\n\t\t\t\tpassword: password,\n\t\t  }),\n\t\t});\n\t\n\t\tif (!response.ok) {\n\t\t\tconsole.log(response.statusText)\n\t\t  setError(response.statusText);\n\t\t} else {\n\t\t\tconst responseObj = await response.json();\n\t\t\tconst error = responseObj.error;\n\t\t\tif (error) {\n\t\t\t\tsetError(error);\n\t\t\t} else {\n\t\t\t\tclearForm();\n\t\t\t\tredirectToLogin();\n\t\t\t}\n\t\t}\n\t}\t\n\n\treturn (\n\t\t<Card\n\t\t\tbgcolor=\"warning\"\n\t\t\theader=\"Open Account\" \n\t\t\tbody={\n\t\t\t\t<>\n\t\t\t\t\t\t{(() => {\n\t\t\t\t\t\t\tif (error) {\n\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\t<div className=\"error\">{error}</div>\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t} \n\t\t\t\t\t\t\t})()}\n\n\t\t\t\t\t{(() => {\n\t\t\t\t\t\t\tif (userNameError) {\n\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\t<div className=\"error\">{userNameError}</div>\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t} \n\t\t\t\t\t\t\t})()}\n\n\t\t\t\t\t\t{(() => {\n\t\t\t\t\t\t\tif (firstNameError) {\n\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\t<div className=\"error\">{firstNameError}</div>\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t} \n\t\t\t\t\t\t\t})()}\n\n\t\t\t\t\t\t\t{(() => {\n\t\t\t\t\t\t\tif (lastNameError) {\n\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\t<div className=\"error\">{lastNameError}</div>\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t} \n\t\t\t\t\t\t\t})()}\n\n\t\t\t\t\t\t\t{(() => {\n\t\t\t\t\t\t\tif (emailError) {\n\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\t<div className=\"error\">{emailError}</div>\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t} \n\t\t\t\t\t\t\t})()}\n\n\t\t\t\t\t\t\t{(() => {\n\t\t\t\t\t\t\tif (passwError) {\n\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\t<div className=\"error\">{passwError}</div>\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t} \n\t\t\t\t\t\t})()}\n\n\t\t\n\t\t\t\t\t<h6 className=\"card-text mt-5 mb-2\">Username</h6>\n\t\t\t\t\t<input type=\"input\" className=\"form-control\" id=\"username\" placeholder=\"Create a username.\" value={userName} onChange={handleUserNameChange}/>\n\t\t\t\t\t<h6 className=\"card-text mt-4 mb-2\">First Name</h6>\n\t\t\t\t\t<input type=\"input\" className=\"form-control\" id=\"name\" placeholder=\"Your first name is...\" value={firstName} onChange={handleFirstNameChange}/>\n\t\t\t\t\t<h6 className=\"card-text mt-4 mb-2\">Last Name</h6>\n\t\t\t\t\t<input type=\"input\" className=\"form-control\" id=\"name\" placeholder=\"Your last name is...\" value={lastName} onChange={handleLastNameChange}/>\n\t\t\t\t\t<br/>\n\t\t\t\t\t<h6 className=\"card-text mb-2\">Email address</h6>\n\t\t\t\t\t<input type=\"input\" className=\"form-control\" id=\"email\" placeholder=\"Your email address is...\" value={email} onChange={handleEmailChange}/>\n\t\t\t\t\t<br/>\n\t\t\t\t\t<h6 className=\"card-text mb-2\">Password</h6>\n\t\t\t\t\t<input type=\"password\" className=\"form-control\" id=\"password\" placeholder=\"**********\" value={password} onChange={handlePasswordChange}/>\n\t\t\t\t\t<br/>\n\t\t\t\t\t<button type=\"submit\" disabled={!userName && !firstName && !lastName && !email && !password} id=\"submitbutton\" className=\"submitBtn btn btn-light\" onClick={e => submitUser()} >Create Account</button>\n\t\t\t\t</>\n\t\t\t}\n\t\t/>\n\t)\n}\n\nexport default CreateAccount;"]},"metadata":{},"sourceType":"module"}