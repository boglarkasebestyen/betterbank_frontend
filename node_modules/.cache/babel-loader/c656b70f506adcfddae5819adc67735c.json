{"ast":null,"code":"import _asyncToGenerator from\"/Users/sebestyenboglarka/Desktop/_uWu/MIT_MERN_2021-'22/3rd semester/badbank_backend_test/betterbank_frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _regeneratorRuntime from\"/Users/sebestyenboglarka/Desktop/_uWu/MIT_MERN_2021-'22/3rd semester/badbank_backend_test/betterbank_frontend/node_modules/@babel/runtime/regenerator/index.js\";import React,{useContext,useEffect}from\"react\";import{MyContext}from\"../myContext/MyContext\";import Card from\"../components/Card\";import Cookies from\"js-cookie\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";function Deposit(){var _useContext=useContext(MyContext),depositAmount=_useContext.depositAmount,balance=_useContext.balance,depositError=_useContext.depositError,error=_useContext.error,depositHandleChange=_useContext.depositHandleChange,validateDeposit=_useContext.validateDeposit,depositSuccessMessageVisible=_useContext.depositSuccessMessageVisible,setError=_useContext.setError,authenticateWithAPI=_useContext.authenticateWithAPI,setDepositSuccessMessageVisible=_useContext.setDepositSuccessMessageVisible,setDepositAmount=_useContext.setDepositAmount,getBalance=_useContext.getBalance;useEffect(function(){getBalance();});// const [deposit, setDeposit] = useState({\n//   amount: \"\" ,\n//   datetime: \"\" \n// });\nfunction submitDeposit(){return _submitDeposit.apply(this,arguments);}function _submitDeposit(){_submitDeposit=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var userToken,username,API_URL,response,responseObj,_error;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(validateDeposit()){_context.next=2;break;}return _context.abrupt(\"return\");case 2:userToken=Cookies.get(\"token\");if(!userToken){authenticateWithAPI();userToken=Cookies.get(\"token\");}username=Cookies.get(\"username\");;if(!username){setError(\"Not logged in!\");}API_URL=process.env.NEXT_PUBLIC_API_URL||\"http://localhost:1337\";_context.next=10;return fetch(\"\".concat(API_URL,\"/transactions/deposit\"),{method:\"POST\",headers:userToken&&{Authorization:\"Bearer \".concat(userToken)},body:JSON.stringify({to:username,from:username,amount:depositAmount})});case 10:response=_context.sent;setError(\"\");if(response.ok){_context.next=17;break;}console.log(response.statusText);setError(response.statusText);_context.next=22;break;case 17:_context.next=19;return response.json();case 19:responseObj=_context.sent;_error=responseObj.error;if(_error){setError(_error);setDepositSuccessMessageVisible(false);}else{setDepositSuccessMessageVisible(true);}case 22:;case 23:case\"end\":return _context.stop();}}},_callee);}));return _submitDeposit.apply(this,arguments);};var clearMsgDeposit=function clearMsgDeposit(){setDepositAmount(\"\");setDepositSuccessMessageVisible(false);};return/*#__PURE__*/_jsx(Card,{bgcolor:\"warning\",header:\"Deposit\",body:/*#__PURE__*/_jsxs(_Fragment,{children:[function(){if(error){return/*#__PURE__*/_jsx(\"div\",{className:\"error\",children:error});}}(),function(){if(depositError){return/*#__PURE__*/_jsx(\"div\",{className:\"error\",children:depositError});}}(),function(){if(depositSuccessMessageVisible===true){return/*#__PURE__*/_jsxs(\"div\",{className:\"successMessage\",children:[/*#__PURE__*/_jsx(\"h5\",{children:\"Awesome!\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Your deposit was received!\"}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",id:\"submitbutton\",className:\"submitBtn btn btn-light\",onClick:function onClick(){return clearMsgDeposit();},children:\"Ok\"})]});}}(),/*#__PURE__*/_jsxs(\"h6\",{className:\"card-text mt-4 mb-5 font-weight-bolder\",children:[\"Your current balance is: $\",balance]}),/*#__PURE__*/_jsx(\"h6\",{className:\"card-text mt-4 mb-2 font-weight-bolder\",children:\"The amount you wish to deposit:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"input\",className:\"form-control\",id:\"depositAmount\",value:depositAmount,onChange:depositHandleChange}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",disabled:!depositAmount,id:\"submitbutton\",className:\"submitBtn btn btn-light\",onClick:function onClick(){return submitDeposit();},children:\"Deposit\"})]})});}export default Deposit;","map":{"version":3,"sources":["/Users/sebestyenboglarka/Desktop/_uWu/MIT_MERN_2021-'22/3rd semester/badbank_backend_test/betterbank_frontend/src/pages/Deposit.js"],"names":["React","useContext","useEffect","MyContext","Card","Cookies","Deposit","depositAmount","balance","depositError","error","depositHandleChange","validateDeposit","depositSuccessMessageVisible","setError","authenticateWithAPI","setDepositSuccessMessageVisible","setDepositAmount","getBalance","submitDeposit","userToken","get","username","API_URL","process","env","NEXT_PUBLIC_API_URL","fetch","method","headers","Authorization","body","JSON","stringify","to","from","amount","response","ok","console","log","statusText","json","responseObj","clearMsgDeposit"],"mappings":"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","sourcesContent":["import React, {useContext, useEffect} from \"react\";\r\nimport {MyContext} from \"../myContext/MyContext\";\r\nimport Card from \"../components/Card\";\r\nimport Cookies from \"js-cookie\";\r\n\r\nfunction Deposit() {\r\n\r\n  const {\r\n    //state:\r\n    depositAmount,\r\n    balance,\r\n    depositError,\r\n    error,\r\n    //functions:\r\n    depositHandleChange,\r\n    validateDeposit,\r\n    depositSuccessMessageVisible,\r\n    setError,\r\n    authenticateWithAPI ,\r\n    setDepositSuccessMessageVisible,\r\n    setDepositAmount,\r\n    getBalance\r\n  } = useContext(MyContext);\r\n\r\n  useEffect(()=> {\r\n    getBalance();\r\n  }); \r\n\r\n\t// const [deposit, setDeposit] = useState({\r\n  //   amount: \"\" ,\r\n  //   datetime: \"\" \r\n\t// });\r\n\r\n  async function submitDeposit() {\r\n    if(!validateDeposit()) {\r\n      return;\r\n    }\r\n\t\r\n\t\tlet userToken = Cookies.get(\"token\");\r\n\t\tif (!userToken) {\r\n\t\t\tauthenticateWithAPI();\r\n\t\t\tuserToken = Cookies.get(\"token\");\r\n\t\t}\r\n\t\t\r\n    let username = Cookies.get(\"username\");;\r\n    if (!username) {\r\n      setError(\"Not logged in!\");\r\n    }\r\n\r\n\t\tconst API_URL = process.env.NEXT_PUBLIC_API_URL || \"http://localhost:1337\";\r\n\t\tconst response = await fetch(`${API_URL}/transactions/deposit`, {\r\n\t\t  method: \"POST\",\r\n\t\t\theaders: userToken && { Authorization: `Bearer ${userToken}` },\r\n\t\t \tbody: JSON.stringify({\r\n        to: username,\r\n        from: username,\r\n        amount: depositAmount\r\n\t\t  }),\r\n\t\t});\r\n\r\n    setError(\"\");\r\n    if (!response.ok) {\r\n\t\t\tconsole.log(response.statusText)\r\n\t\t  setError(response.statusText);\r\n\t\t} else {\r\n\t\t\tconst responseObj = await response.json();\r\n\t\t\tconst error = responseObj.error;\r\n\t\t\tif (error) {\r\n\t\t\t\tsetError(error);\r\n        setDepositSuccessMessageVisible(false)\r\n\t\t\t} else {\r\n        setDepositSuccessMessageVisible(true);\r\n      }\r\n\t\t};\r\n  };\r\n\r\n  let clearMsgDeposit = () => {\r\n    setDepositAmount(\"\");\r\n    setDepositSuccessMessageVisible(false);\r\n  }\r\n\r\n  return (\r\n    <Card\r\n        bgcolor=\"warning\"\r\n        header=\"Deposit\"\r\n        body= {\r\n          <>  \r\n\r\n            {(() => {\r\n\t\t\t\t\t\t\tif (error) {\r\n\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t<div className=\"error\">{error}</div>\r\n\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t} \r\n\t\t\t\t\t\t\t})()}\r\n\r\n          \t{(() => {\r\n              if (depositError) {\r\n                return (\r\n                  <div className=\"error\">{depositError}</div>\r\n                  );\r\n              }\r\n            })()}\r\n\r\n            {(() => {\r\n\t\t\t\t\t\t\tif (depositSuccessMessageVisible === true) {\r\n\t\t\t\t\t\t\t\treturn (\r\n                  <div className=\"successMessage\">\r\n                    <h5>Awesome!</h5>\r\n                    <p>Your deposit was received!</p>\r\n                    <button type=\"submit\" id=\"submitbutton\" className=\"submitBtn btn btn-light\" onClick={() => clearMsgDeposit()}>Ok</button>             \r\n                  </div>\r\n\t\t\t\t        );\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t})()}\r\n\r\n          \t<h6 className=\"card-text mt-4 mb-5 font-weight-bolder\">Your current balance is: ${balance}</h6>\r\n\t\t\t\t\t\t<h6 className=\"card-text mt-4 mb-2 font-weight-bolder\">The amount you wish to deposit:</h6>\r\n            {/* added value so that state can change */}\r\n\t\t\t\t\t\t<input type=\"input\" className=\"form-control\" id=\"depositAmount\" value={depositAmount} onChange={depositHandleChange}/>\r\n\t\t\t\t\t\t<br/>                                                                              \r\n\t\t\t\t\t\t<button type=\"submit\" disabled={!depositAmount} id =\"submitbutton\" className=\"submitBtn btn btn-light\" onClick={() => submitDeposit()}>Deposit</button>            \r\n          </>\r\n        }  \r\n    />\r\n  )\r\n}\r\n\r\nexport default Deposit;\r\n"]},"metadata":{},"sourceType":"module"}